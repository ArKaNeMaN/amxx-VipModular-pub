# Настройки

Основные моменты при настройке системы привилегий.

- Ссылки на файлы
- Главный файл
- Проверки
- Модули
- Глобальные настройки модулей

__ВАЖНО: _Все конфиг-файлы должны соответствовать формату JSON. Допускаются комментарии вида `/* comment */` или `// comment`.___

## Ссылки на файлы

В целях оптимизации и разбиения конфигов на отдельные файлы, некоторые элементы конфига могут быть заменены на ссылку вида `"File:<path>/<file>"`.

- `<path>` - путь до файла, относительно папки `amxmodx/configs/plugins/VipModular/`.
- `<file>` - название `.json` файла без расширения.

При повторном обращении к файлу по ссылке, вместо чтения файла, на место ссылки будет подставлен обьект, прочитанный из этого файла в первый раз.

## Главный файл

Основным файлом настроек является файл `amxmodx/configs/plugins/VipModular/Vips.json`.

### Структура главного файла

```jsonc
[
    {
        "Access": [ /* ... */ ],
        "Modules": [ /* ... */ ]
    },
    { /* ... */ }
]
```

### Корневой массив

Элементами корневого массива являются обьекты, содержащие поля `Access` и `Modules`.

### Поле `Access`

Поле `Access` содержит одну или более проверок, привязанных к игроку.

_Если проверка одна, она может быть указана как обьект, вместо массива._

_Может являться ссылкой на файл. Как массив, так и элементы массива._

### Поле `Modules`

Поле `Modules` содержит один или более модулей, которые будут выданы игроку, если он прошёл все проверки из поля `Access`.

_Если модуль один, он может быть указан как обьект, вместо массива._

_Может являться ссылкой на файл. Как массив, так и элементы массива._

## Проверки

Список доступных типов проверок может быть расширен специальными плагинами-расширениями с приставкой `L`.

Типы проверок деляться на две подгруппы: __Привязанные к игрокам__ и __свободные__.

- __Проверки, привязанные к игрокам__ не могут быть использованы в конфигах, не применяемых к игрокам, например, в глобальных настройках модулей.
- __Свободные проверки__ могут использоваться в любых списках проверок.

### Структура обьекта проверки

```jsonc
{
    "Limit": "<LimitTypeName>",

    "<Param1>": "",
    /* ... */
    "<ParamN>": []
}
```

- `<LimitTypeName>` - название типа проверки. Определяется плагином-расширением, регистрирующим тип проверки.
- `<ParamX>` - какой-либо параметр проверки. Названия и типы параметров определяются плагином-расширением, добавляющим тип проверки.

## Модули

Проверки - обьект, выдаваемый игроку и выполняющий при этом некоторые действия, определённые плагином-расширением.

Список доступных модулей может быть расширен специальными плагинами-расширениями с приставкой `M`.

### Структура обьекта модуля

```jsonc
{
    "Module": "<ModuleName>",

    "<Param1>": "",
    /* ... */
    "<ParamN>": []
}
```

- `<ModuleName>` - название типа проверки. Определяется плагином-расширением, регистрирующим модуль.
- `<ParamX>` - какой-либо параметр модуля. Названия и типы параметров определяются плагином-расширением, добавляющим модуль.

## Глобальные настройки модулей

_Данный функционал пока не реализован в том виде, в котором был запланирован._

Ниже будет представлено временное решение, позволяющее указывать для каждой карты набор модулей, который будут на ней доступны.

Файл глобальных настроек модулей: `amxmodx/configs/plugins/VipModular/Maps.json`.

### Структура файла глобальных настроек модулей

```jsonc
{
    "_ALL": [/* Список названий модулей */],

    "<MapName1>": [/* Список названий модулей */],
    /* ... */
    "<MapNameN>": [/* Список названий модулей */],
}
```

- `_ALL` - поле, определяющее список модулей для карт, не указаных явно в данном файле.
- `<MapNameX>` - название карты, для которой определяется список активных модулей.
